<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Manage Users - Super Admin | Nemionix Technologies</title>
    <meta name="description" content="Manage all platform users - students, clubs, and administrators">
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=Poppins:wght@600;700;800&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --primary-50: #FFF8E1;
            --primary-100: #FFECB3;
            --primary-500: #FFC107;
            --primary-600: #FFB300;
            --primary-700: #FFA000;
            --secondary-500: #1991EB;
            --secondary-600: #1474BC;
            --accent-500: #FF9119;
            --gray-50: #F9FAFB;
            --gray-100: #F3F4F6;
            --gray-200: #E5E7EB;
            --gray-300: #D1D5DB;
            --gray-400: #9CA3AF;
            --gray-500: #6B7280;
            --gray-600: #4B5563;
            --gray-700: #374151;
            --gray-800: #1F2937;
            --gray-900: #111827;
            --success: #10B981;
            --warning: #F59E0B;
            --error: #EF4444;
            --info: #3B82F6;
            --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            --shadow-base: 0 1px 3px 0 rgba(0, 0, 0, 0.1);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
            --radius-lg: 0.5rem;
            --radius-xl: 0.75rem;
            --radius-2xl: 1rem;
            --radius-full: 9999px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: var(--gray-50);
            color: var(--gray-900);
            line-height: 1.6;
        }

        /* Navigation */
        .navbar {
            background: white;
            box-shadow: var(--shadow-sm);
            position: sticky;
            top: 0;
            z-index: 1000;
            border-bottom: 1px solid var(--gray-200);
        }

        .navbar-container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 1rem 1.5rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            text-decoration: none;
            color: var(--gray-900);
        }

        .logo-icon {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, var(--primary-500), var(--primary-700));
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 800;
            font-size: 1.25rem;
            font-family: 'Poppins', sans-serif;
        }

        .logo-text h1 {
            font-family: 'Poppins', sans-serif;
            font-size: 1.25rem;
            font-weight: 700;
        }

        .logo-text p {
            font-size: 0.7rem;
            color: var(--gray-500);
        }

        .admin-badge {
            background: linear-gradient(135deg, var(--error), #DC2626);
            color: white;
            padding: 0.375rem 0.75rem;
            border-radius: var(--radius-full);
            font-size: 0.75rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .nav-actions {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .user-avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            object-fit: cover;
            border: 2px solid var(--primary-500);
        }

        /* Dashboard Layout */
        .dashboard-layout {
            display: flex;
            min-height: calc(100vh - 72px);
            max-width: 1600px;
            margin: 0 auto;
        }

        /* Sidebar */
        .sidebar {
            width: 280px;
            background: white;
            border-right: 1px solid var(--gray-200);
            position: fixed;
            height: calc(100vh - 72px);
            overflow-y: auto;
        }

        .sidebar-nav {
            padding: 1rem 0;
        }

        .nav-section-title {
            padding: 0.5rem 1.5rem;
            font-size: 0.75rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: var(--gray-500);
        }

        .nav-link {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0.75rem 1.5rem;
            color: var(--gray-700);
            text-decoration: none;
            transition: all 0.2s;
            font-size: 0.9375rem;
            font-weight: 500;
        }

        .nav-link:hover {
            background: var(--gray-50);
            color: var(--primary-600);
        }

        .nav-link.active {
            background: rgba(255, 193, 7, 0.1);
            color: var(--primary-600);
            border-right: 3px solid var(--primary-500);
            font-weight: 600;
        }

        .nav-link-content {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .nav-badge {
            background: var(--error);
            color: white;
            padding: 0.125rem 0.5rem;
            border-radius: var(--radius-full);
            font-size: 0.75rem;
            font-weight: 700;
            min-width: 20px;
            text-align: center;
        }

        /* Main Content */
        .main-content {
            flex: 1;
            margin-left: 280px;
            padding: 2rem;
        }

        /* Page Header */
        .page-header {
            margin-bottom: 2rem;
        }

        .page-title {
            font-family: 'Poppins', sans-serif;
            font-size: 2rem;
            font-weight: 800;
            color: var(--gray-900);
            margin-bottom: 0.5rem;
        }

        .page-subtitle {
            color: var(--gray-600);
            font-size: 0.9375rem;
        }

        /* Stats Bar */
        .stats-bar {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: white;
            border-radius: var(--radius-2xl);
            padding: 1.5rem;
            box-shadow: var(--shadow-base);
            position: relative;
            overflow: hidden;
            transition: all 0.3s;
        }

        .stat-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
        }

        .stat-card.total::before {
            background: linear-gradient(90deg, var(--info), #2563EB);
        }

        .stat-card.students::before {
            background: linear-gradient(90deg, var(--success), #059669);
        }

        .stat-card.clubs::before {
            background: linear-gradient(90deg, var(--primary-500), var(--primary-700));
        }

        .stat-card.admins::before {
            background: linear-gradient(90deg, var(--error), #DC2626);
        }

        .stat-label {
            font-size: 0.875rem;
            color: var(--gray-600);
            font-weight: 500;
            margin-bottom: 0.5rem;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 800;
            font-family: 'Poppins', sans-serif;
            color: var(--gray-900);
        }

        /* Filters Section */
        .filters-section {
            background: white;
            border-radius: var(--radius-2xl);
            padding: 1.5rem;
            box-shadow: var(--shadow-base);
            margin-bottom: 2rem;
        }

        .filters-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .filter-group {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .filter-label {
            font-size: 0.875rem;
            font-weight: 600;
            color: var(--gray-700);
        }

        .filter-input,
        .filter-select {
            padding: 0.625rem 0.875rem;
            border: 2px solid var(--gray-200);
            border-radius: var(--radius-lg);
            font-size: 0.875rem;
            transition: all 0.2s;
            font-family: inherit;
        }

        .filter-input:focus,
        .filter-select:focus {
            outline: none;
            border-color: var(--primary-500);
            box-shadow: 0 0 0 3px rgba(255, 193, 7, 0.1);
        }

        .filter-actions {
            display: flex;
            gap: 1rem;
        }

        .btn {
            padding: 0.625rem 1.25rem;
            border-radius: var(--radius-lg);
            font-weight: 600;
            font-size: 0.875rem;
            cursor: pointer;
            transition: all 0.2s;
            border: none;
            font-family: inherit;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary-500), var(--primary-700));
            color: white;
            box-shadow: var(--shadow-md);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .btn-secondary {
            background: white;
            color: var(--gray-700);
            border: 2px solid var(--gray-300);
        }

        .btn-secondary:hover {
            background: var(--gray-50);
            border-color: var(--gray-400);
        }

        /* Users Table */
        .users-table-container {
            background: white;
            border-radius: var(--radius-2xl);
            box-shadow: var(--shadow-base);
            overflow: hidden;
        }

        .table-header {
            padding: 1.5rem;
            border-bottom: 1px solid var(--gray-200);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .table-title {
            font-family: 'Poppins', sans-serif;
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--gray-900);
        }

        .export-btn {
            padding: 0.5rem 1rem;
            background: var(--success);
            color: white;
            border: none;
            border-radius: var(--radius-lg);
            font-weight: 600;
            font-size: 0.875rem;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .export-btn:hover {
            background: #059669;
            transform: translateY(-1px);
        }

        .table-wrapper {
            overflow-x: auto;
            max-width: 100%;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            table-layout: fixed;
        }

        thead {
            background: var(--gray-50);
        }

        th {
            padding: 0.75rem 1rem;
            text-align: left;
            font-size: 0.75rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: var(--gray-700);
            border-bottom: 1px solid var(--gray-200);
            white-space: nowrap;
        }

        th.sortable {
            cursor: pointer;
            user-select: none;
        }

        th.sortable:hover {
            background: var(--gray-100);
        }

        td {
            padding: 0.75rem 1rem;
            border-bottom: 1px solid var(--gray-200);
            font-size: 0.875rem;
        }

        tr:hover {
            background: var(--gray-50);
        }

        .user-info-cell {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .user-avatar-table {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            object-fit: cover;
            flex-shrink: 0;
            border: 2px solid var(--gray-200);
        }

        .user-details {
            flex: 1;
        }

        .user-name {
            font-weight: 600;
            color: var(--gray-900);
            margin-bottom: 0.25rem;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .user-email {
            font-size: 0.8125rem;
            color: var(--gray-500);
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .role-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.375rem;
            padding: 0.375rem 0.75rem;
            border-radius: var(--radius-full);
            font-size: 0.75rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .role-student {
            background: rgba(59, 130, 246, 0.1);
            color: var(--info);
        }

        .role-club_admin {
            background: rgba(255, 193, 7, 0.1);
            color: var(--primary-600);
        }

        .role-super_admin {
            background: rgba(239, 68, 68, 0.1);
            color: var(--error);
        }

        .status-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.375rem;
            padding: 0.375rem 0.75rem;
            border-radius: var(--radius-full);
            font-size: 0.75rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .status-active {
            background: rgba(16, 185, 129, 0.1);
            color: var(--success);
        }

        .status-suspended {
            background: rgba(239, 68, 68, 0.1);
            color: var(--error);
        }

        .status-dot {
            width: 6px;
            height: 6px;
            border-radius: 50%;
        }

        .status-active .status-dot {
            background: var(--success);
            box-shadow: 0 0 8px var(--success);
        }

        .status-suspended .status-dot {
            background: var(--error);
            box-shadow: 0 0 8px var(--error);
        }

        .actions-cell {
            display: flex;
            align-items: center;
            gap: 0.375rem;
            flex-wrap: nowrap;
        }

        .action-btn {
            padding: 0.375rem 0.5rem;
            border-radius: var(--radius-lg);
            font-size: 0.875rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            border: none;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.25rem;
            min-width: 32px;
            height: 32px;
        }

        .action-btn-view {
            background: var(--info);
            color: white;
        }

        .action-btn-view:hover {
            background: #2563EB;
            transform: translateY(-1px);
        }

        .action-btn-suspend {
            background: var(--warning);
            color: white;
        }

        .action-btn-suspend:hover {
            background: #D97706;
            transform: translateY(-1px);
        }

        .action-btn-ban {
            background: var(--error);
            color: white;
        }

        .action-btn-ban:hover {
            background: #DC2626;
            transform: translateY(-1px);
        }

        .action-btn-logs {
            background: var(--gray-600);
            color: white;
        }

        .action-btn-logs:hover {
            background: var(--gray-700);
            transform: translateY(-1px);
        }
.action-btn-delete {
            background: #8B0000;
            color: white;
        }

        .action-btn-delete:hover {
            background: #660000;
            transform: translateY(-1px);
        }
        /* Pagination */
        .pagination {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1.5rem;
            border-top: 1px solid var(--gray-200);
        }

        .pagination-info {
            font-size: 0.875rem;
            color: var(--gray-600);
        }

        .pagination-controls {
            display: flex;
            gap: 0.5rem;
        }

        .page-btn {
            padding: 0.5rem 0.875rem;
            border: 1px solid var(--gray-300);
            background: white;
            border-radius: var(--radius-lg);
            font-size: 0.875rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }

        .page-btn:hover:not(:disabled) {
            background: var(--gray-50);
            border-color: var(--primary-500);
        }

        .page-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .page-btn.active {
            background: var(--primary-500);
            color: white;
            border-color: var(--primary-500);
        }

        /* Modal */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(4px);
            z-index: 9999;
            align-items: center;
            justify-content: center;
            padding: 2rem;
        }

        .modal-overlay.show {
            display: flex;
        }

        .modal {
            background: white;
            border-radius: var(--radius-2xl);
            max-width: 700px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: var(--shadow-xl);
        }

        .modal-header {
            padding: 1.5rem;
            border-bottom: 1px solid var(--gray-200);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-title {
            font-family: 'Poppins', sans-serif;
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--gray-900);
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 1.5rem;
            color: var(--gray-500);
            cursor: pointer;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: all 0.2s;
        }

        .modal-close:hover {
            background: var(--gray-100);
            color: var(--gray-700);
        }

        .modal-body {
            padding: 1.5rem;
        }

        .user-profile-header {
            display: flex;
            align-items: center;
            gap: 1.5rem;
            padding: 1.5rem;
            background: var(--gray-50);
            border-radius: var(--radius-xl);
            margin-bottom: 1.5rem;
        }

        .user-avatar-large {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            object-fit: cover;
            border: 4px solid white;
            box-shadow: var(--shadow-lg);
            flex-shrink: 0;
        }

        .user-profile-info {
            flex: 1;
        }

        .user-name-large {
            font-family: 'Poppins', sans-serif;
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--gray-900);
            margin-bottom: 0.25rem;
        }

        .user-email-large {
            color: var(--gray-600);
            font-size: 0.9375rem;
            margin-bottom: 0.75rem;
        }

        .user-meta-row {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .detail-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .detail-item {
            padding: 1rem;
            background: var(--gray-50);
            border-radius: var(--radius-lg);
        }

        .detail-label {
            font-size: 0.8125rem;
            color: var(--gray-600);
            font-weight: 500;
            margin-bottom: 0.25rem;
        }

        .detail-value {
            font-size: 0.9375rem;
            color: var(--gray-900);
            font-weight: 600;
        }

        .activity-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .activity-stat-card {
            padding: 1rem;
            background: linear-gradient(135deg, var(--primary-50), white);
            border-radius: var(--radius-lg);
            border: 1px solid var(--primary-100);
            text-align: center;
        }

        .activity-stat-value {
            font-size: 1.5rem;
            font-weight: 800;
            font-family: 'Poppins', sans-serif;
            color: var(--primary-600);
            margin-bottom: 0.25rem;
        }

        .activity-stat-label {
            font-size: 0.8125rem;
            color: var(--gray-600);
            font-weight: 500;
        }

        .recent-activity-section {
            margin-top: 1.5rem;
        }

        .section-title {
            font-family: 'Poppins', sans-serif;
            font-size: 1.125rem;
            font-weight: 700;
            color: var(--gray-900);
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid var(--gray-200);
        }

        .activity-list {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
            max-height: 300px;
            overflow-y: auto;
        }

        .activity-item {
            padding: 0.875rem;
            background: var(--gray-50);
            border-radius: var(--radius-lg);
            display: flex;
            align-items: flex-start;
            gap: 0.75rem;
        }

        .activity-icon {
            width: 32px;
            height: 32px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1rem;
            background: white;
            flex-shrink: 0;
        }

        .activity-content {
            flex: 1;
        }

        .activity-text {
            font-size: 0.875rem;
            color: var(--gray-900);
            margin-bottom: 0.25rem;
        }

        .activity-time {
            font-size: 0.75rem;
            color: var(--gray-500);
        }

        .modal-footer {
            padding: 1.5rem;
            border-top: 1px solid var(--gray-200);
            display: flex;
            gap: 1rem;
            justify-content: flex-end;
        }

        .warning-box {
            padding: 1rem;
            background: rgba(239, 68, 68, 0.1);
            border-left: 4px solid var(--error);
            border-radius: var(--radius-lg);
            margin-bottom: 1rem;
        }

        .warning-text {
            color: var(--error);
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .modal-text {
            color: var(--gray-700);
            margin-bottom: 1rem;
            line-height: 1.6;
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 4rem 2rem;
        }

        .empty-icon {
            font-size: 4rem;
            margin-bottom: 1rem;
            opacity: 0.5;
        }

        .empty-title {
            font-family: 'Poppins', sans-serif;
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--gray-900);
            margin-bottom: 0.5rem;
        }

        .empty-text {
            color: var(--gray-600);
        }

        /* Loading */
        .loading-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(4px);
            z-index: 10000;
            align-items: center;
            justify-content: center;
        }

        .loading-overlay.show {
            display: flex;
        }

        .spinner {
            width: 50px;
            height: 50px;
            border: 4px solid var(--gray-200);
            border-top-color: var(--primary-500);
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Toast */
        .toast {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            background: white;
            padding: 1rem 1.5rem;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-xl);
            display: flex;
            align-items: center;
            gap: 0.75rem;
            z-index: 10001;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from {
                transform: translateX(400px);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        .toast-success {
            border-left: 4px solid var(--success);
        }

        .toast-error {
            border-left: 4px solid var(--error);
        }

        .toast-info {
            border-left: 4px solid var(--info);
        }

        /* Responsive */
        @media (max-width: 1280px) {
            .filters-grid {
                grid-template-columns: repeat(3, 1fr);
            }

            .stats-bar {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 1024px) {
            .sidebar {
                transform: translateX(-100%);
                transition: transform 0.3s;
            }

            .sidebar.show {
                transform: translateX(0);
            }

            .main-content {
                margin-left: 0;
            }

            .filters-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .detail-grid {
                grid-template-columns: 1fr;
            }

            .activity-stats {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .main-content {
                padding: 1rem;
            }

            .page-title {
                font-size: 1.5rem;
            }

            .stats-bar {
                grid-template-columns: 1fr;
            }

            .filters-grid {
                grid-template-columns: 1fr;
            }

            .table-wrapper {
                overflow-x: scroll;
            }

            table {
                min-width: 1000px;
            }

            .pagination {
                flex-direction: column;
                gap: 1rem;
            }

            .user-profile-header {
                flex-direction: column;
                text-align: center;
            }
        }
    </style>
</head>
<body>
    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="spinner"></div>
    </div>

    <!-- Navigation -->
    <nav class="navbar">
        <div class="navbar-container">
            <a href="index.html" class="logo">
                <div class="logo-icon">NX</div>
                <div class="logo-text">
                    <h1>Nemionix Technologies</h1>
                    <p>Engineering the Future, Today</p>
                </div>
            </a>

            <div class="nav-actions">
                <div class="admin-badge">SUPER ADMIN</div>
                <div class="user-info">
                    <img src="https://ui-avatars.com/api/?name=Admin&background=FFC107&color=fff&size=128" alt="Admin" class="user-avatar" id="userAvatar">
                    <span id="userName">Loading...</span>
                </div>
            </div>
        </div>
    </nav>

    <div class="dashboard-layout">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <nav class="sidebar-nav">
                <div class="nav-section-title">Overview</div>
                <a href="super-admin-dashboard.html" class="nav-link">
                    <div class="nav-link-content">
                        <span>üìä</span>
                        <span>Dashboard</span>
                    </div>
                </a>

                <div class="nav-section-title">Management</div>
                <a href="manage-clubs.html" class="nav-link">
                    <div class="nav-link-content">
                        <span>üè¢</span>
                        <span>Manage Clubs</span>
                    </div>
                </a>
                <a href="club-applications.html" class="nav-link">
                    <div class="nav-link-content">
                        <span>üìù</span>
                        <span>Club Applications</span>
                    </div>
                    <span class="nav-badge" id="pendingClubsBadge">0</span>
                </a>
                <a href="manage-users.html" class="nav-link active">
                    <div class="nav-link-content">
                        <span>üë•</span>
                        <span>Manage Users</span>
                    </div>
                </a>
                <a href="manage-all-products.html" class="nav-link">
                    <div class="nav-link-content">
                        <span>üì¶</span>
                        <span>Manage Products</span>
                    </div>
                </a>
                <a href="manage-all-competitions.html" class="nav-link">
                    <div class="nav-link-content">
                        <span>üèÜ</span>
                        <span>Manage Competitions</span>
                    </div>
                </a>
                <a href="manage-all-orders.html" class="nav-link">
                    <div class="nav-link-content">
                        <span>üõí</span>
                        <span>Orders Overview</span>
                    </div>
                </a>

                <div class="nav-section-title">Financial</div>
                <a href="financial-admin.html" class="nav-link">
                    <div class="nav-link-content">
                        <span>üí∞</span>
                        <span>Financial Management</span>
                    </div>
                </a>
                <a href="reward-system-admin.html" class="nav-link">
                    <div class="nav-link-content">
                        <span>üèÖ</span>
                        <span>Reward System</span>
                    </div>
                </a>

                <div class="nav-section-title">System</div>
                <a href="platform-settings.html" class="nav-link">
                    <div class="nav-link-content">
                        <span>‚öôÔ∏è</span>
                        <span>Platform Settings</span>
                    </div>
                </a>
                <a href="analytics.html" class="nav-link">
                    <div class="nav-link-content">
                        <span>üìà</span>
                        <span>Analytics</span>
                    </div>
                </a>
                <a href="activity-logs.html" class="nav-link">
                    <div class="nav-link-content">
                        <span>üìã</span>
                        <span>Activity Logs</span>
                    </div>
                </a>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Page Header -->
            <div class="page-header">
                <h1 class="page-title">Manage Users</h1>
                <p class="page-subtitle">View and manage all platform users - students, clubs, and administrators</p>
            </div>

            <!-- Stats Bar -->
            <div class="stats-bar">
                <div class="stat-card total">
                    <div class="stat-label">Total Users</div>
                    <div class="stat-value" id="totalUsers">0</div>
                </div>
                <div class="stat-card students">
                    <div class="stat-label">Students</div>
                    <div class="stat-value" id="totalStudents">0</div>
                </div>
                <div class="stat-card clubs">
                    <div class="stat-label">Club Admins</div>
                    <div class="stat-value" id="totalClubAdmins">0</div>
                </div>
                <div class="stat-card admins">
                    <div class="stat-label">Super Admins</div>
                    <div class="stat-value" id="totalSuperAdmins">0</div>
                </div>
            </div>

            <!-- Filters Section -->
            <div class="filters-section">
                <div class="filters-grid">
                    <div class="filter-group">
                        <label class="filter-label">Role</label>
                        <select class="filter-select" id="roleFilter">
                            <option value="">All</option>
                            <option value="student">Student</option>
                            <option value="club_admin">Club Admin</option>
                            <option value="super_admin">Super Admin</option>
                        </select>
                    </div>

                    <div class="filter-group">
                        <label class="filter-label">Status</label>
                        <select class="filter-select" id="statusFilter">
                            <option value="">All</option>
                            <option value="active">Active</option>
                            <option value="suspended">Suspended</option>
                        </select>
                    </div>

                    <div class="filter-group">
                        <label class="filter-label">University</label>
                        <select class="filter-select" id="universityFilter">
                            <option value="">All Universities</option>
                            <option value="BUET">BUET</option>
                            <option value="CUET">CUET</option>
                            <option value="RUET">RUET</option>
                            <option value="Green University">Green University</option>
                            <option value="DIU">DIU</option>
                            <option value="NSU">NSU</option>
                            <option value="BRAC University">BRAC University</option>
                        </select>
                    </div>

                    <div class="filter-group">
                        <label class="filter-label">Search</label>
                        <input type="text" class="filter-input" id="searchFilter" placeholder="Name, email...">
                    </div>

                    <div class="filter-group">
                        <label class="filter-label">Sort By</label>
                        <select class="filter-select" id="sortFilter">
                            <option value="newest">Newest First</option>
                            <option value="oldest">Oldest First</option>
                            <option value="name_asc">Name (A-Z)</option>
                            <option value="name_desc">Name (Z-A)</option>
                            <option value="activity">Most Active</option>
                        </select>
                    </div>
                </div>

                <div class="filter-actions">
                    <button class="btn btn-primary" id="applyFiltersBtn">Apply Filters</button>
                    <button class="btn btn-secondary" id="clearFiltersBtn">Clear All</button>
                </div>
            </div>

            <!-- Users Table -->
            <div class="users-table-container">
                <div class="table-header">
                    <h2 class="table-title">Users List</h2>
                    <button class="export-btn" id="exportBtn">
                        <span>üì•</span>
                        <span>Export to Excel</span>
                    </button>
                </div>

                <div class="table-wrapper">
                    <table>
                        <thead>
                            <tr>
                                <th style="width: 50px;">Avatar</th>
                                <th class="sortable" data-sort="name" style="width: 140px;">Name</th>
                                <th class="sortable" data-sort="email" style="width: 160px;">Email</th>
                                <th class="sortable" data-sort="role" style="width: 110px;">Role</th>
                                <th class="sortable" data-sort="university" style="width: 90px;">University</th>
                                <th class="sortable" data-sort="joined" style="width: 90px;">Joined</th>
                                <th class="sortable" data-sort="last_login" style="width: 90px;">Last Login</th>
                                <th class="sortable" data-sort="status" style="width: 85px;">Status</th>
                                <th style="width: 180px;">Actions</th>
                            </tr>
                        </thead>
                        <tbody id="usersTableBody">
                            <!-- Data loaded dynamically -->
                        </tbody>
                    </table>
                </div>

                <!-- Pagination -->
                <div class="pagination">
                    <div class="pagination-info" id="paginationInfo">
                        Showing 0 of 0 users
                    </div>
                    <div class="pagination-controls" id="paginationControls">
                        <!-- Pagination buttons loaded dynamically -->
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- View Details Modal -->
    <div class="modal-overlay" id="viewModal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title">User Details</h3>
                <button class="modal-close" onclick="closeModal('viewModal')">√ó</button>
            </div>
            <div class="modal-body" id="viewModalBody">
                <!-- User details loaded here -->
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('viewModal')">Close</button>
            </div>
        </div>
    </div>

    <!-- Suspend Modal -->
    <div class="modal-overlay" id="suspendModal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title">Suspend User</h3>
                <button class="modal-close" onclick="closeModal('suspendModal')">√ó</button>
            </div>
            <div class="modal-body">
                <p class="modal-text">Are you sure you want to suspend this user? They will not be able to access their account while suspended.</p>
                <p class="modal-text" style="font-weight: 600; color: var(--gray-900);" id="suspendUserName"></p>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('suspendModal')">Cancel</button>
                <button class="btn btn-primary" style="background: var(--warning);" id="confirmSuspendBtn">Suspend User</button>
            </div>
        </div>
    </div>

    <!-- Ban Modal -->
    <div class="modal-overlay" id="banModal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title">Ban User</h3>
                <button class="modal-close" onclick="closeModal('banModal')">√ó</button>
            </div>
            <div class="modal-body">
                <div class="warning-box">
                    <p class="warning-text">
                        <span>‚ö†Ô∏è</span>
                        <span>This action will permanently ban this user!</span>
                    </p>
                </div>
                <p class="modal-text">Are you sure you want to permanently ban this user? This action cannot be easily undone and the user will lose all access.</p>
                <p class="modal-text" style="font-weight: 600; color: var(--gray-900);" id="banUserName"></p>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('banModal')">Cancel</button>
                <button class="btn btn-primary" style="background: var(--error);" id="confirmBanBtn">Ban User</button>
            </div>
        </div>
    </div>

    <!-- Delete Modal -->
    <div class="modal-overlay" id="deleteModal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title">Delete User Permanently</h3>
                <button class="modal-close" onclick="closeModal('deleteModal')">√ó</button>
            </div>
            <div class="modal-body">
                <div class="warning-box">
                    <p class="warning-text">
                        <span>‚ö†Ô∏è</span>
                        <span>This action CANNOT be undone!</span>
                    </p>
                </div>
                <p class="modal-text">Are you sure you want to <strong>permanently delete</strong> this user? All their data including orders, reviews, and activity will be removed from the system.</p>
                <p class="modal-text" style="font-weight: 600; color: var(--gray-900);" id="deleteUserName"></p>
                <p class="modal-text" style="color: var(--error); font-size: 0.875rem;">‚ö†Ô∏è This action is irreversible!</p>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('deleteModal')">Cancel</button>
                <button class="btn btn-primary" style="background: #8B0000;" id="confirmDeleteBtn">Delete Permanently</button>
            </div>
        </div>
    </div>
    <script>
        // Configuration
        const API_BASE_URL = 'http://localhost:3000/api';
        
        // State
        let currentUser = null;
        let allUsers = [];
        let filteredUsers = [];
        let currentPage = 1;
        const itemsPerPage = 20;
        let currentUserAction = null;

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            checkAuth();
            loadUsers();
            initializeEventListeners();
        });

        // Check Authentication
        function checkAuth() {
            const token = localStorage.getItem('token');
            const user = JSON.parse(localStorage.getItem('user') || 'null');

            if (!token || !user || user.role !== 'super_admin') {
                window.location.href = 'login.html';
                return;
            }

            currentUser = user;
            document.getElementById('userName').textContent = currentUser.full_name || 'Admin';
            const avatarElement = document.getElementById('userAvatar');
            if (currentUser.avatar_url) {
                avatarElement.src = currentUser.avatar_url;
            } else {
                const userName = encodeURIComponent(currentUser.full_name || 'Admin');
                avatarElement.src = `https://ui-avatars.com/api/?name=${userName}&background=FFC107&color=fff&size=128`;
            }
        }

        // Initialize Event Listeners
        function initializeEventListeners() {
            // Apply filters
            document.getElementById('applyFiltersBtn').addEventListener('click', applyFilters);

            // Clear filters
            document.getElementById('clearFiltersBtn').addEventListener('click', clearFilters);

            // Search input with debounce
            let searchTimeout;
            document.getElementById('searchFilter').addEventListener('input', (e) => {
                clearTimeout(searchTimeout);
                searchTimeout = setTimeout(() => {
                    applyFilters();
                }, 500);
            });

            // Export button
            document.getElementById('exportBtn').addEventListener('click', exportToExcel);

            // Confirm suspend
            document.getElementById('confirmSuspendBtn').addEventListener('click', confirmSuspend);

            // Confirm ban
            document.getElementById('confirmBanBtn').addEventListener('click', confirmBan);

            // Confirm delete
            document.getElementById('confirmDeleteBtn').addEventListener('click', confirmDelete);
        }

        // Load Users
        async function loadUsers() {
            try {
                showLoading();
                const token = localStorage.getItem('token');
                const response = await fetch(`${API_BASE_URL}/super-admin/users`, {
                    headers: {
                        'Authorization': `Bearer ${token}`
                    }
                });

                if (!response.ok) throw new Error('Failed to load users');

                const data = await response.json();
                allUsers = data.users || [];
                filteredUsers = [...allUsers];

                updateStats(data.stats);
                renderUsers();
            } catch (error) {
                console.error('Error:', error);
                showToast('Failed to load users', 'error');
            } finally {
                hideLoading();
            }
        }

        // Update Stats
        function updateStats(stats) {
            document.getElementById('totalUsers').textContent = stats.total || 0;
            document.getElementById('totalStudents').textContent = stats.students || 0;
            document.getElementById('totalClubAdmins').textContent = stats.club_admins || 0;
            document.getElementById('totalSuperAdmins').textContent = stats.super_admins || 0;
        }

        // Apply Filters
        function applyFilters() {
            const role = document.getElementById('roleFilter').value;
            const status = document.getElementById('statusFilter').value;
            const university = document.getElementById('universityFilter').value;
            const search = document.getElementById('searchFilter').value.toLowerCase();
            const sort = document.getElementById('sortFilter').value;

            filteredUsers = allUsers.filter(user => {
                if (role && user.role !== role) return false;
                if (status) {
                    // Users without is_suspended field are considered active
                    const userStatus = (user.is_suspended === true) ? 'suspended' : 'active';
                    if (userStatus !== status) return false;
                }
                if (university && user.university !== university) return false;
                if (search) {
                    const searchStr = `${user.full_name} ${user.email}`.toLowerCase();
                    if (!searchStr.includes(search)) return false;
                }
                return true;
            });

            // Sort
            sortUsers(sort);

            currentPage = 1;
            renderUsers();
        }

        // Sort Users
        function sortUsers(sortBy) {
            switch (sortBy) {
                case 'name_asc':
                    filteredUsers.sort((a, b) => a.full_name.localeCompare(b.full_name));
                    break;
                case 'name_desc':
                    filteredUsers.sort((a, b) => b.full_name.localeCompare(a.full_name));
                    break;
                case 'newest':
                    filteredUsers.sort((a, b) => new Date(b.created_at) - new Date(a.created_at));
                    break;
                case 'oldest':
                    filteredUsers.sort((a, b) => new Date(a.created_at) - new Date(b.created_at));
                    break;
                case 'activity':
                    filteredUsers.sort((a, b) => new Date(b.last_login) - new Date(a.last_login));
                    break;
            }
        }

        // Clear Filters
        function clearFilters() {
            document.getElementById('roleFilter').value = '';
            document.getElementById('statusFilter').value = '';
            document.getElementById('universityFilter').value = '';
            document.getElementById('searchFilter').value = '';
            document.getElementById('sortFilter').value = 'newest';
            applyFilters();
        }

        // Render Users
        function renderUsers() {
            const tbody = document.getElementById('usersTableBody');
            const startIndex = (currentPage - 1) * itemsPerPage;
            const endIndex = startIndex + itemsPerPage;
            const pageUsers = filteredUsers.slice(startIndex, endIndex);

            if (pageUsers.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="9">
                            <div class="empty-state">
                                <div class="empty-icon">üë•</div>
                                <h3 class="empty-title">No Users Found</h3>
                                <p class="empty-text">No users match your current filters. Try adjusting your search criteria.</p>
                            </div>
                        </td>
                    </tr>
                `;
                updatePaginationInfo(0, 0, 0);
                return;
            }

            tbody.innerHTML = pageUsers.map(user => {
                const userStatus = (user.is_suspended === true) ? 'suspended' : 'active';
                const roleDisplay = user.role.replace('_', ' ').split(' ').map(w => w.charAt(0).toUpperCase() + w.slice(1)).join(' ');
                const avatarUrl = user.avatar_url || `https://ui-avatars.com/api/?name=${encodeURIComponent(user.full_name || 'User')}&background=FFC107&color=fff&size=128`;
                
                return `
                    <tr>
                        <td>
                            <img src="${avatarUrl}" 
                                 alt="${user.full_name || 'User'}" 
                                 class="user-avatar-table">
                        </td>
                        <td>
                            <div class="user-details">
                                <div class="user-name">${user.full_name}</div>
                            </div>
                        </td>
                        <td>
                            <div class="user-email">${user.email}</div>
                        </td>
                        <td>
                            <span class="role-badge role-${user.role}">
                                ${getRoleIcon(user.role)} ${roleDisplay}
                            </span>
                        </td>
                        <td>${user.university || 'N/A'}</td>
                        <td>${formatDate(user.created_at)}</td>
                        <td>${user.last_login ? formatTimeAgo(user.last_login) : 'Never'}</td>
                        <td>
                            <span class="status-badge status-${userStatus}">
                                <span class="status-dot"></span>
                                ${userStatus.charAt(0).toUpperCase() + userStatus.slice(1)}
                            </span>
                        </td>
                        <td>
                            <div class="actions-cell">
                                <button class="action-btn action-btn-view" onclick="viewUserDetails(${user.id})" title="View Details">
                                    üëÅÔ∏è
                                </button>
                                ${(user.is_suspended !== true) && user.role !== 'super_admin' ? `
                                    <button class="action-btn action-btn-suspend" onclick="openSuspendModal(${user.id}, '${user.full_name}')" title="Suspend">
                                        ‚õî
                                    </button>
                                ` : ''}
                                ${user.role !== 'super_admin' ? `
                                    <button class="action-btn action-btn-ban" onclick="openBanModal(${user.id}, '${user.full_name}')" title="Ban">
                                        üö´
                                    </button>
                                    <button class="action-btn action-btn-delete" onclick="openDeleteModal(${user.id}, '${user.full_name}')" title="Delete Permanently">
                                        üóëÔ∏è
                                    </button>
                                ` : ''}
                                <button class="action-btn action-btn-logs" onclick="viewActivityLogs(${user.id})" title="Activity Logs">
                                    üìã
                                </button>
                            </div>
                        </td>
                    </tr>
                `;
            }).join('');

            updatePaginationInfo(startIndex + 1, Math.min(endIndex, filteredUsers.length), filteredUsers.length);
            renderPagination();
        }

        // View User Details
        async function viewUserDetails(userId) {
            try {
                showLoading();
                const token = localStorage.getItem('token');
                const response = await fetch(`${API_BASE_URL}/super-admin/users/${userId}`, {
                    headers: {
                        'Authorization': `Bearer ${token}`
                    }
                });

                if (!response.ok) throw new Error('Failed to load user details');

                const data = await response.json();
                
                // Handle both response formats
                const user = data.success ? data : data;
                
                renderUserDetailsModal(user);
                document.getElementById('viewModal').classList.add('show');

            } catch (error) {
                console.error('Error:', error);
                showToast('Failed to load user details', 'error');
            } finally {
                hideLoading();
            }
        }

        // Render User Details Modal
        function renderUserDetailsModal(user) {
            const modalBody = document.getElementById('viewModalBody');
            
            // Safe role handling
            const role = user.role || 'unknown';
            const roleDisplay = role.replace('_', ' ').split(' ').map(w => w.charAt(0).toUpperCase() + w.slice(1)).join(' ');
            const userStatus = (user.is_suspended === true) ? 'suspended' : 'active';

            const modalAvatarUrl = user.avatar_url || `https://ui-avatars.com/api/?name=${encodeURIComponent(user.full_name || 'User')}&background=FFC107&color=fff&size=256`;
            
            modalBody.innerHTML = `
                <!-- User Profile Header -->
                <div class="user-profile-header">
                    <img src="${modalAvatarUrl}" 
                         alt="${user.full_name || 'User'}" 
                         class="user-avatar-large">
                    <div class="user-profile-info">
                        <h2 class="user-name-large">${user.full_name}</h2>
                        <p class="user-email-large">${user.email}</p>
                        <div class="user-meta-row">
                            <span class="role-badge role-${user.role}">
                                ${getRoleIcon(user.role)} ${roleDisplay}
                            </span>
                            <span class="status-badge status-${userStatus}">
                                <span class="status-dot"></span>
                                ${userStatus.charAt(0).toUpperCase() + userStatus.slice(1)}
                            </span>
                        </div>
                    </div>
                </div>

                <!-- User Details -->
                <div class="detail-grid">
                    <div class="detail-item">
                        <div class="detail-label">Phone</div>
                        <div class="detail-value">${user.phone || 'N/A'}</div>
                    </div>
                    <div class="detail-item">
                        <div class="detail-label">University</div>
                        <div class="detail-value">${user.university || 'N/A'}</div>
                    </div>
                    ${user.student_id ? `
                        <div class="detail-item">
                            <div class="detail-label">Student ID</div>
                            <div class="detail-value">${user.student_id}</div>
                        </div>
                    ` : ''}
                    ${user.department ? `
                        <div class="detail-item">
                            <div class="detail-label">Department</div>
                            <div class="detail-value">${user.department}</div>
                        </div>
                    ` : ''}
                    <div class="detail-item">
                        <div class="detail-label">Joined Date</div>
                        <div class="detail-value">${formatDate(user.created_at)}</div>
                    </div>
                    <div class="detail-item">
                        <div class="detail-label">Last Login</div>
                        <div class="detail-value">${user.last_login ? formatTimeAgo(user.last_login) : 'Never'}</div>
                    </div>
                    <div class="detail-item">
                        <div class="detail-label">Email Verified</div>
                        <div class="detail-value">${user.is_verified ? '‚úì Yes' : '‚úó No'}</div>
                    </div>
                    ${user.club_name ? `
                        <div class="detail-item">
                            <div class="detail-label">Club</div>
                            <div class="detail-value">${user.club_name}</div>
                        </div>
                    ` : ''}
                </div>

                <!-- Activity Statistics -->
                ${user.activity_stats ? `
                    <div class="activity-stats">
                        <div class="activity-stat-card">
                            <div class="activity-stat-value">${user.activity_stats.orders || 0}</div>
                            <div class="activity-stat-label">Orders</div>
                        </div>
                        <div class="activity-stat-card">
                            <div class="activity-stat-value">${user.activity_stats.competitions || 0}</div>
                            <div class="activity-stat-label">Competitions</div>
                        </div>
                        <div class="activity-stat-card">
                            <div class="activity-stat-value">${user.activity_stats.reviews || 0}</div>
                            <div class="activity-stat-label">Reviews</div>
                        </div>
                    </div>
                ` : ''}

                <!-- Recent Activity -->
                ${user.recent_activity && user.recent_activity.length > 0 ? `
                    <div class="recent-activity-section">
                        <h3 class="section-title">Recent Activity</h3>
                        <div class="activity-list">
                            ${user.recent_activity.map(activity => `
                                <div class="activity-item">
                                    <div class="activity-icon">${getActivityIcon(activity.action_type)}</div>
                                    <div class="activity-content">
                                        <div class="activity-text">${activity.description}</div>
                                        <div class="activity-time">${formatTimeAgo(activity.created_at)}</div>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                ` : ''}
            `;
        }

        // Open Suspend Modal
        function openSuspendModal(userId, userName) {
            currentUserAction = userId;
            document.getElementById('suspendUserName').textContent = userName;
            document.getElementById('suspendModal').classList.add('show');
        }

        // Confirm Suspend
        async function confirmSuspend() {
            if (!currentUserAction) return;

            try {
                showLoading();
                const token = localStorage.getItem('token');
                const response = await fetch(`${API_BASE_URL}/super-admin/users/${currentUserAction}/suspend`, {
                    method: 'PUT',
                    headers: {
                        'Authorization': `Bearer ${token}`
                    }
                });

                if (!response.ok) throw new Error('Failed to suspend user');

                showToast('User suspended successfully', 'success');
                closeModal('suspendModal');
                await loadUsers();
            } catch (error) {
                console.error('Error:', error);
                showToast('Failed to suspend user', 'error');
            } finally {
                hideLoading();
                currentUserAction = null;
            }
        }

        // Open Ban Modal
        function openBanModal(userId, userName) {
            currentUserAction = userId;
            document.getElementById('banUserName').textContent = userName;
            document.getElementById('banModal').classList.add('show');
        }

        // Confirm Ban
        async function confirmBan() {
            if (!currentUserAction) return;

            try {
                showLoading();
                const token = localStorage.getItem('token');
                const response = await fetch(`${API_BASE_URL}/super-admin/users/${currentUserAction}/ban`, {
                    method: 'PUT',
                    headers: {
                        'Authorization': `Bearer ${token}`
                    }
                });

                if (!response.ok) throw new Error('Failed to ban user');

                showToast('User banned successfully', 'success');
                closeModal('banModal');
                await loadUsers();
            } catch (error) {
                console.error('Error:', error);
                showToast('Failed to ban user', 'error');
            } finally {
                hideLoading();
                currentUserAction = null;
            }
        }

        // View Activity Logs
        function viewActivityLogs(userId) {
            window.location.href = `activity-logs.html?user_id=${userId}`;
        }

        // Open Delete Modal
        function openDeleteModal(userId, userName) {
            currentUserAction = userId;
            document.getElementById('deleteUserName').textContent = userName;
            document.getElementById('deleteModal').classList.add('show');
        }

        // Confirm Delete
        async function confirmDelete() {
            if (!currentUserAction) return;

            try {
                showLoading();
                const token = localStorage.getItem('token');
                const response = await fetch(`${API_BASE_URL}/super-admin/users/${currentUserAction}`, {
                    method: 'DELETE',
                    headers: {
                        'Authorization': `Bearer ${token}`
                    }
                });

                if (!response.ok) throw new Error('Failed to delete user');

                showToast('User deleted permanently', 'success');
                closeModal('deleteModal');
                await loadUsers();
            } catch (error) {
                console.error('Error:', error);
                showToast('Failed to delete user', 'error');
            } finally {
                hideLoading();
                currentUserAction = null;
            }
        }
        // Export to Excel
        function exportToExcel() {
            const csvContent = [
                ['Name', 'Email', 'Role', 'University', 'Joined Date', 'Last Login', 'Status'].join(','),
                ...filteredUsers.map(user => {
                    const roleDisplay = user.role.replace('_', ' ');
                    const userStatus = user.is_suspended ? 'Suspended' : 'Active';
                    return [
                        user.full_name,
                        user.email,
                        roleDisplay,
                        user.university || 'N/A',
                        formatDate(user.created_at),
                        user.last_login ? formatDate(user.last_login) : 'Never',
                        userStatus
                    ].join(',');
                })
            ].join('\n');

            const blob = new Blob([csvContent], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `users_export_${new Date().toISOString().split('T')[0]}.csv`;
            a.click();
            window.URL.revokeObjectURL(url);

            showToast('Users exported successfully', 'success');
        }

        // Update Pagination Info
        function updatePaginationInfo(start, end, total) {
            document.getElementById('paginationInfo').textContent = 
                `Showing ${start}-${end} of ${total} users`;
        }

        // Render Pagination
        function renderPagination() {
            const totalPages = Math.ceil(filteredUsers.length / itemsPerPage);
            const controls = document.getElementById('paginationControls');

            if (totalPages <= 1) {
                controls.innerHTML = '';
                return;
            }

            let html = `
                <button class="page-btn" ${currentPage === 1 ? 'disabled' : ''} onclick="changePage(${currentPage - 1})">
                    Previous
                </button>
            `;

            const maxVisiblePages = 5;
            let startPage = Math.max(1, currentPage - Math.floor(maxVisiblePages / 2));
            let endPage = Math.min(totalPages, startPage + maxVisiblePages - 1);

            if (endPage - startPage < maxVisiblePages - 1) {
                startPage = Math.max(1, endPage - maxVisiblePages + 1);
            }

            for (let i = startPage; i <= endPage; i++) {
                html += `
                    <button class="page-btn ${i === currentPage ? 'active' : ''}" onclick="changePage(${i})">
                        ${i}
                    </button>
                `;
            }

            html += `
                <button class="page-btn" ${currentPage === totalPages ? 'disabled' : ''} onclick="changePage(${currentPage + 1})">
                    Next
                </button>
            `;

            controls.innerHTML = html;
        }

        // Change Page
        function changePage(page) {
            const totalPages = Math.ceil(filteredUsers.length / itemsPerPage);
            if (page < 1 || page > totalPages) return;
            currentPage = page;
            renderUsers();
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // Close Modal
        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('show');
            currentUserAction = null;
        }

        // Helper Functions
        function getRoleIcon(role) {
            const icons = {
                student: 'üéì',
                club_admin: 'üè¢',
                super_admin: 'üëë'
            };
            return icons[role] || 'üë§';
        }

        function getActivityIcon(actionType) {
            const icons = {
                'order_placed': 'üõí',
                'competition_registered': 'üèÜ',
                'review_posted': '‚≠ê',
                'product_created': 'üì¶',
                'competition_created': 'üéØ',
                'profile_updated': '‚úèÔ∏è',
                'login': 'üîë'
            };
            return icons[actionType] || 'üìå';
        }

        function formatDate(dateString) {
            if (!dateString) return 'N/A';
            const date = new Date(dateString);
            return date.toLocaleDateString('en-BD', {
                year: 'numeric',
                month: 'short',
                day: 'numeric'
            });
        }

        function formatTimeAgo(dateString) {
            if (!dateString) return 'Never';
            const date = new Date(dateString);
            const now = new Date();
            const seconds = Math.floor((now - date) / 1000);

            if (seconds < 60) return 'Just now';
            if (seconds < 3600) return `${Math.floor(seconds / 60)} minutes ago`;
            if (seconds < 86400) return `${Math.floor(seconds / 3600)} hours ago`;
            if (seconds < 604800) return `${Math.floor(seconds / 86400)} days ago`;
            return formatDate(dateString);
        }

        function showLoading() {
            document.getElementById('loadingOverlay').classList.add('show');
        }

        function hideLoading() {
            document.getElementById('loadingOverlay').classList.remove('show');
        }

        function showToast(message, type = 'info') {
            const existingToast = document.querySelector('.toast');
            if (existingToast) existingToast.remove();

            const toast = document.createElement('div');
            toast.className = `toast toast-${type}`;
            toast.innerHTML = `
                <span style="font-size: 1.25rem;">${type === 'success' ? '‚úì' : type === 'error' ? '‚úó' : '‚Ñπ'}</span>
                <span>${message}</span>
            `;
            document.body.appendChild(toast);

            setTimeout(() => {
                toast.style.animation = 'slideOut 0.3s ease';
                setTimeout(() => toast.remove(), 300);
            }, 3000);
        }

        // Close modals on overlay click
        document.querySelectorAll('.modal-overlay').forEach(overlay => {
            overlay.addEventListener('click', (e) => {
                if (e.target === overlay) {
                    overlay.classList.remove('show');
                }
            });
        });

        // Add slide out animation
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideOut {
                to {
                    transform: translateX(400px);
                    opacity: 0;
                }
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>